{
  "version": 3,
  "sources": ["../../../src/plugins/lib/ruuvi-tag_protocol.ts"],
  "sourcesContent": ["import { stripUndefinedProperties } from \"../../lib/object-polyfill\";\n\nexport interface RuuviContext {\n\tdataFormat: number;\n\ttemperature?: number;\n\thumidity?: number;\n\tpressure?: number;\n\tacceleration?: {\n\t\tx: number;\n\t\ty: number;\n\t\tz: number;\n\t};\n\tbattery?: number;\n\ttxPower?: number;\n\tmovementCounter?: number;\n\tsequenceNumber?: number;\n\tmacAddress?: string;\n\tbeaconID?: number;\n}\n\nexport function parseDataFormat2or4(data: Buffer): RuuviContext {\n\tconst dataFormat = data[0];\n\n\tconst humidity = data.readUInt8(1) * 0.5;\n\n\tconst temperature = data.readInt8(2);\n\n\tconst pressure = (data.readUInt16BE(4) + 50000) / 100; // hPa\n\n\tconst ret: RuuviContext = {\n\t\tdataFormat,\n\t\thumidity,\n\t\ttemperature,\n\t\tpressure,\n\t};\n\tif (dataFormat === 4 && data.length >= 6) {\n\t\tret.beaconID = data[6];\n\t}\n\treturn ret;\n}\n\nexport function parseDataFormat3(data: Buffer): RuuviContext {\n\tconst dataFormat = data[0];\n\n\tconst humidity = data.readUInt8(1) * 0.5;\n\n\tconst temperature = data.readInt8(2) + data[3] / 100;\n\n\tconst pressure = (data.readUInt16BE(4) + 50000) / 100; // hPa\n\n\tconst acceleration = {\n\t\tx: data.readInt16BE(6),\n\t\ty: data.readInt16BE(8),\n\t\tz: data.readInt16BE(10),\n\t};\n\n\tconst battery = data.readUInt16BE(12) / 1000; // mV -> V\n\n\treturn {\n\t\tdataFormat,\n\t\thumidity,\n\t\ttemperature,\n\t\tpressure,\n\t\tacceleration,\n\t\tbattery,\n\t};\n}\n\nexport function parseDataFormat5(data: Buffer): RuuviContext {\n\tconst dataFormat = data[0];\n\n\tlet temperature: number | undefined = data.readInt16BE(1);\n\ttemperature = temperature !== 0x8000 ? temperature * 0.005 : undefined;\n\n\tlet humidity: number | undefined = data.readUInt16BE(3);\n\thumidity = humidity !== 0xffff ? humidity * 0.0025 : undefined;\n\n\tlet pressure: number | undefined = data.readUInt16BE(5);\n\tpressure = pressure !== 0xffff ? (pressure + 50000) / 100 : undefined; // hPa\n\n\tlet acceleration:\n\t\t| { [key in \"x\" | \"y\" | \"z\"]: number | undefined }\n\t\t| undefined = {\n\t\tx: data.readInt16BE(7),\n\t\ty: data.readInt16BE(9),\n\t\tz: data.readInt16BE(11),\n\t};\n\tacceleration.x =\n\t\tacceleration.x !== 0x8000 ? acceleration.x! * 0.001 : undefined;\n\tacceleration.y =\n\t\tacceleration.y !== 0x8000 ? acceleration.y! * 0.001 : undefined;\n\tacceleration.z =\n\t\tacceleration.z !== 0x8000 ? acceleration.z! * 0.001 : undefined;\n\tif (\n\t\tacceleration.x == undefined &&\n\t\tacceleration.y == undefined &&\n\t\tacceleration.z == undefined\n\t)\n\t\tacceleration = undefined;\n\n\tconst power = data.readUInt16BE(13);\n\tlet battery: number | undefined;\n\tlet txPower: number | undefined;\n\tif (power >>> 5 !== 0b111_1111_1111) battery = (power >>> 5) * 0.001 + 1.6;\n\tif ((power & 0b11111) !== 0b11111) txPower = (power & 0b11111) * 2 - 40;\n\n\tlet movementCounter: number | undefined = data[15];\n\tif (movementCounter === 0xff) movementCounter = undefined;\n\n\tlet sequenceNumber: number | undefined = data.readUInt16BE(16);\n\tif (sequenceNumber === 0xffff) sequenceNumber = undefined;\n\n\tlet macAddress: string | undefined = data.slice(18, 24).toString(\"hex\");\n\tif (macAddress === \"ffffffffffff\") macAddress = undefined;\n\n\treturn stripUndefinedProperties({\n\t\tdataFormat,\n\t\ttemperature,\n\t\thumidity,\n\t\tpressure,\n\t\tacceleration,\n\t\tbattery,\n\t\ttxPower,\n\t\tmovementCounter,\n\t\tsequenceNumber,\n\t\tmacAddress,\n\t}) as any as RuuviContext;\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAyC;AAoBlC,6BAA6B,MAA4B;AAC/D,QAAM,aAAa,KAAK;AAExB,QAAM,WAAW,KAAK,UAAU,CAAC,IAAI;AAErC,QAAM,cAAc,KAAK,SAAS,CAAC;AAEnC,QAAM,WAAY,MAAK,aAAa,CAAC,IAAI,OAAS;AAElD,QAAM,MAAoB;AAAA,IACzB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD;AACA,MAAI,eAAe,KAAK,KAAK,UAAU,GAAG;AACzC,QAAI,WAAW,KAAK;AAAA,EACrB;AACA,SAAO;AACR;AAEO,0BAA0B,MAA4B;AAC5D,QAAM,aAAa,KAAK;AAExB,QAAM,WAAW,KAAK,UAAU,CAAC,IAAI;AAErC,QAAM,cAAc,KAAK,SAAS,CAAC,IAAI,KAAK,KAAK;AAEjD,QAAM,WAAY,MAAK,aAAa,CAAC,IAAI,OAAS;AAElD,QAAM,eAAe;AAAA,IACpB,GAAG,KAAK,YAAY,CAAC;AAAA,IACrB,GAAG,KAAK,YAAY,CAAC;AAAA,IACrB,GAAG,KAAK,YAAY,EAAE;AAAA,EACvB;AAEA,QAAM,UAAU,KAAK,aAAa,EAAE,IAAI;AAExC,SAAO;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD;AACD;AAEO,0BAA0B,MAA4B;AAC5D,QAAM,aAAa,KAAK;AAExB,MAAI,cAAkC,KAAK,YAAY,CAAC;AACxD,gBAAc,gBAAgB,QAAS,cAAc,OAAQ;AAE7D,MAAI,WAA+B,KAAK,aAAa,CAAC;AACtD,aAAW,aAAa,QAAS,WAAW,QAAS;AAErD,MAAI,WAA+B,KAAK,aAAa,CAAC;AACtD,aAAW,aAAa,QAAU,YAAW,OAAS,MAAM;AAE5D,MAAI,eAEW;AAAA,IACd,GAAG,KAAK,YAAY,CAAC;AAAA,IACrB,GAAG,KAAK,YAAY,CAAC;AAAA,IACrB,GAAG,KAAK,YAAY,EAAE;AAAA,EACvB;AACA,eAAa,IACZ,aAAa,MAAM,QAAS,aAAa,IAAK,OAAQ;AACvD,eAAa,IACZ,aAAa,MAAM,QAAS,aAAa,IAAK,OAAQ;AACvD,eAAa,IACZ,aAAa,MAAM,QAAS,aAAa,IAAK,OAAQ;AACvD,MACC,aAAa,KAAK,UAClB,aAAa,KAAK,UAClB,aAAa,KAAK;AAElB,mBAAe;AAEhB,QAAM,QAAQ,KAAK,aAAa,EAAE;AAClC,MAAI;AACJ,MAAI;AACJ,MAAI,UAAU,MAAM;AAAiB,cAAW,WAAU,KAAK,OAAQ;AACvE,MAAK,SAAQ,QAAa;AAAS,cAAW,SAAQ,MAAW,IAAI;AAErE,MAAI,kBAAsC,KAAK;AAC/C,MAAI,oBAAoB;AAAM,sBAAkB;AAEhD,MAAI,iBAAqC,KAAK,aAAa,EAAE;AAC7D,MAAI,mBAAmB;AAAQ,qBAAiB;AAEhD,MAAI,aAAiC,KAAK,MAAM,IAAI,EAAE,EAAE,SAAS,KAAK;AACtE,MAAI,eAAe;AAAgB,iBAAa;AAEhD,SAAO,qDAAyB;AAAA,IAC/B;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,CAAC;AACF;",
  "names": []
}
